__merge__: ../../api/comp_method.yaml

functionality:
  name: gpcounts
  info:
    label: GPcounts
    summary: "GPcounts is non-parametric modelling of temporal and spatial counts data from RNA-seq experiments."
    description: |
      The GPcounts package implements GP regression methods for modelling counts data using a 
      negative binomial likelihood function. Computational efficiency is achieved through the use of 
      variational Bayesian inference. The GP function models changes in the mean of the negative binomial 
      likelihood through a logarithmic link function and the dispersion parameter is fitted by maximum 
      likelihood. We validate the method on simulated time course data, showing better performance to identify 
      changes in over-dispersed counts data than methods based on Gaussian or Poisson likelihoods. 
      To demonstrate temporal inference, we apply GPcounts to single-cell RNA-seq datasets after pseudotime and 
      branching inference. To demonstrate spatial inference, we apply GPcounts to data from the mouse olfactory 
      bulb to identify spatially variable genes and compare to two published GP methods. We also provide the option 
      of modelling additional dropout using a zero-inflated negative binomial. 
      Our results show that GPcounts can be used to model temporal and spatial counts data in cases where 
      simpler Gaussian and Poisson likelihoods are unrealistic.
    preferred_normalization: counts
    reference: bintayyash2021non
    documentation_url: https://github.com/ManchesterBioinference/GPcounts/blob/master/demo_notebooks/GPcounts_spatial.ipynb
    repository_url: https://github.com/ManchesterBioinference/GPcounts

  resources:
    - type: python_script
      path: script.py

platforms:
  - type: docker
    image: python:3.9.16
    setup:
      - type: apt
        packages: 
          - git
          - procps
          - libhdf5-dev
      - type: python
        packages:
          - anndata
          - scanpy
          - numpy==1.22.4 
          - matplotlib==3.7.1 
          - tensorflow-probability==0.19.0 
          - tensorflow==2.12.0 
          - gpflow
          - check_shapes==1.0.0
      - type: docker
        run : |
          git clone https://github.com/markvdw/RobustGP.git /opt/RobustGP
      - type: docker
        run : |
          git clone https://github.com/ManchesterBioinference/GPcounts.git /opt/GPcounts
      - type: python
        packages: 
          - /opt/RobustGP
          - /opt/GPcounts
  - type: native
  - type: nextflow
    directives:
      label: [midtime, midmem, midcpu, gpu]
